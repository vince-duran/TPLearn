// TPLearn DFD Level 1 - Working DBML Code
// Created: October 31, 2025
// Purpose: Clean DBML representation for dbdiagram.io
// Copy this code to dbdiagram.io to generate the diagram

Project TPLearn_DFD {
  database_type: 'PostgreSQL'
  Note: '''
    TPLearn Learning Management System - DFD Level 1
    Complete data flow representation using DBML
    
    Components:
    - 3 External Entities (Students, Tutors, Admins)
    - 8 Core Processes (1.0 through 8.0)
    - 9 Data Stores (D1 through D9)
    - 51 Total Data Flows (22 input + 21 write + 8 read)
  '''
}

// ========================================
// EXTERNAL ENTITIES
// ========================================

Table students {
  student_id varchar [pk]
  entity_type varchar [default: 'external_entity']
  interactions text
  
  Note: 'Students - Learners using the platform for education'
}

Table tutors {
  tutor_id varchar [pk]
  entity_type varchar [default: 'external_entity']
  interactions text
  
  Note: 'Tutors - Instructors providing educational services'
}

Table admins {
  admin_id varchar [pk]
  entity_type varchar [default: 'external_entity']
  interactions text
  
  Note: 'Admins - System administrators managing the platform'
}

// ========================================
// CORE PROCESSES
// ========================================

Table process_1_0_auth_profile {
  process_id varchar [pk, default: '1.0']
  process_name varchar [default: 'User Authentication & Profile Management']
  description text
  complexity varchar [default: 'High']
  
  Note: 'Manages user registration, authentication, profile updates, and role-based access'
}

Table process_2_0_program_enrollment {
  process_id varchar [pk, default: '2.0']
  process_name varchar [default: 'Program & Enrollment Management']
  description text
  complexity varchar [default: 'High']
  
  Note: 'Handles academic programs, student enrollments, and tutor assignments'
}

Table process_3_0_session_attendance {
  process_id varchar [pk, default: '3.0']
  process_name varchar [default: 'Session & Attendance Management']
  description text
  complexity varchar [default: 'Medium']
  
  Note: 'Manages live sessions, attendance tracking, and session scheduling'
}

Table process_4_0_assessment_submission {
  process_id varchar [pk, default: '4.0']
  process_name varchar [default: 'Assessment & Submission System']
  description text
  complexity varchar [default: 'Medium']
  
  Note: 'Handles assignments, student submissions, grading, and academic feedback'
}

Table process_5_0_payment_financial {
  process_id varchar [pk, default: '5.0']
  process_name varchar [default: 'Payment & Financial Processing']
  description text
  complexity varchar [default: 'High']
  
  Note: 'Manages payments, financial transactions, and billing operations'
}

Table process_6_0_communication_notification {
  process_id varchar [pk, default: '6.0']
  process_name varchar [default: 'Communication & Notification System']
  description text
  complexity varchar [default: 'Low']
  
  Note: 'Manages system notifications, alerts, and communication workflows'
}

Table process_7_0_file_document {
  process_id varchar [pk, default: '7.0']
  process_name varchar [default: 'File & Document Management']
  description text
  complexity varchar [default: 'Low']
  
  Note: 'Handles file uploads, document storage, and content management'
}

Table process_8_0_reporting_analytics {
  process_id varchar [pk, default: '8.0']
  process_name varchar [default: 'Reporting & Analytics System']
  description text
  complexity varchar [default: 'Medium']
  
  Note: 'Generates reports, analytics, and business intelligence'
}

// ========================================
// DATA STORES
// ========================================

Table datastore_d1_users {
  store_id varchar [pk, default: 'D1']
  store_name varchar [default: 'Users Database']
  tables text [default: 'users, student_profiles, tutor_profiles, parent_profiles']
  access_pattern varchar [default: 'High Read/Write']
  
  Note: 'Master repository for all user accounts and profiles'
}

Table datastore_d2_programs {
  store_id varchar [pk, default: 'D2']
  store_name varchar [default: 'Programs Database']
  tables text [default: 'programs, program_materials']
  access_pattern varchar [default: 'Medium Read/Write']
  
  Note: 'Academic programs and curriculum data'
}

Table datastore_d3_enrollments {
  store_id varchar [pk, default: 'D3']
  store_name varchar [default: 'Enrollments Database']
  tables text [default: 'enrollments']
  access_pattern varchar [default: 'High Read/Medium Write']
  
  Note: 'Student enrollment records and status'
}

Table datastore_d4_sessions {
  store_id varchar [pk, default: 'D4']
  store_name varchar [default: 'Sessions Database']
  tables text [default: 'jitsi_meetings, attendance_sessions, attendance_records']
  access_pattern varchar [default: 'Medium Read/Write']
  
  Note: 'Live session and attendance tracking data'
}

Table datastore_d5_assessments {
  store_id varchar [pk, default: 'D5']
  store_name varchar [default: 'Assessments Database']
  tables text [default: 'submissions, student_grades, payment_attachments']
  access_pattern varchar [default: 'Medium Read/Write']
  
  Note: 'Student submissions, grades, and assessment data'
}

Table datastore_d6_payments {
  store_id varchar [pk, default: 'D6']
  store_name varchar [default: 'Payments Database']
  tables text [default: 'payments, ewallet_accounts, bank_accounts, cash_settings']
  access_pattern varchar [default: 'Medium Read/High Write']
  
  Note: 'Financial transactions and payment processing records'
}

Table datastore_d7_communications {
  store_id varchar [pk, default: 'D7']
  store_name varchar [default: 'Communications Database']
  tables text [default: 'notifications']
  access_pattern varchar [default: 'High Read/High Write']
  
  Note: 'System notifications and communication logs'
}

Table datastore_d8_files {
  store_id varchar [pk, default: 'D8']
  store_name varchar [default: 'Files Database']
  tables text [default: 'file_uploads']
  access_pattern varchar [default: 'Medium Read/Write']
  
  Note: 'Document storage and file management'
}

Table datastore_d9_system_config {
  store_id varchar [pk, default: 'D9']
  store_name varchar [default: 'System Configuration']
  tables text [default: 'system_settings, activity_logs, login_attempts']
  access_pattern varchar [default: 'Low Read/High Write']
  
  Note: 'System configuration and audit logs'
}

// ========================================
// DATA FLOWS (Relationships)
// ========================================

// External Entity Input Flows (22 flows)
Ref: students.student_id > process_1_0_auth_profile.process_id
Ref: students.student_id > process_2_0_program_enrollment.process_id
Ref: students.student_id > process_3_0_session_attendance.process_id
Ref: students.student_id > process_4_0_assessment_submission.process_id
Ref: students.student_id > process_5_0_payment_financial.process_id
Ref: students.student_id > process_6_0_communication_notification.process_id
Ref: students.student_id > process_7_0_file_document.process_id
Ref: students.student_id > process_8_0_reporting_analytics.process_id

Ref: tutors.tutor_id > process_1_0_auth_profile.process_id
Ref: tutors.tutor_id > process_2_0_program_enrollment.process_id
Ref: tutors.tutor_id > process_3_0_session_attendance.process_id
Ref: tutors.tutor_id > process_4_0_assessment_submission.process_id
Ref: tutors.tutor_id > process_6_0_communication_notification.process_id
Ref: tutors.tutor_id > process_7_0_file_document.process_id
Ref: tutors.tutor_id > process_8_0_reporting_analytics.process_id

Ref: admins.admin_id > process_1_0_auth_profile.process_id
Ref: admins.admin_id > process_2_0_program_enrollment.process_id
Ref: admins.admin_id > process_3_0_session_attendance.process_id
Ref: admins.admin_id > process_5_0_payment_financial.process_id
Ref: admins.admin_id > process_6_0_communication_notification.process_id
Ref: admins.admin_id > process_7_0_file_document.process_id
Ref: admins.admin_id > process_8_0_reporting_analytics.process_id

// Process to Data Store Flows (Write Operations - 21 flows)
Ref: process_1_0_auth_profile.process_id > datastore_d1_users.store_id
Ref: process_1_0_auth_profile.process_id > datastore_d7_communications.store_id
Ref: process_1_0_auth_profile.process_id > datastore_d9_system_config.store_id

Ref: process_2_0_program_enrollment.process_id > datastore_d2_programs.store_id
Ref: process_2_0_program_enrollment.process_id > datastore_d3_enrollments.store_id
Ref: process_2_0_program_enrollment.process_id > datastore_d7_communications.store_id
Ref: process_2_0_program_enrollment.process_id > datastore_d9_system_config.store_id

Ref: process_3_0_session_attendance.process_id > datastore_d4_sessions.store_id
Ref: process_3_0_session_attendance.process_id > datastore_d7_communications.store_id
Ref: process_3_0_session_attendance.process_id > datastore_d9_system_config.store_id

Ref: process_4_0_assessment_submission.process_id > datastore_d5_assessments.store_id
Ref: process_4_0_assessment_submission.process_id > datastore_d7_communications.store_id
Ref: process_4_0_assessment_submission.process_id > datastore_d8_files.store_id

Ref: process_5_0_payment_financial.process_id > datastore_d6_payments.store_id
Ref: process_5_0_payment_financial.process_id > datastore_d7_communications.store_id
Ref: process_5_0_payment_financial.process_id > datastore_d9_system_config.store_id

Ref: process_6_0_communication_notification.process_id > datastore_d7_communications.store_id
Ref: process_6_0_communication_notification.process_id > datastore_d9_system_config.store_id

Ref: process_7_0_file_document.process_id > datastore_d8_files.store_id
Ref: process_7_0_file_document.process_id > datastore_d9_system_config.store_id

Ref: process_8_0_reporting_analytics.process_id > datastore_d9_system_config.store_id

// Data Store to Process Flows (Read Operations - 8 flows)
// Only keeping read flows that don't create circular references

Ref: datastore_d1_users.store_id > process_6_0_communication_notification.process_id
Ref: datastore_d1_users.store_id > process_8_0_reporting_analytics.process_id

Ref: datastore_d3_enrollments.store_id > process_8_0_reporting_analytics.process_id

Ref: datastore_d4_sessions.store_id > process_8_0_reporting_analytics.process_id

Ref: datastore_d5_assessments.store_id > process_8_0_reporting_analytics.process_id

Ref: datastore_d6_payments.store_id > process_8_0_reporting_analytics.process_id

Ref: datastore_d8_files.store_id > process_4_0_assessment_submission.process_id

Ref: datastore_d9_system_config.store_id > process_1_0_auth_profile.process_id

// ========================================
// VISUAL GROUPING
// ========================================

TableGroup external_entities {
  students
  tutors
  admins
}

TableGroup core_processes {
  process_1_0_auth_profile
  process_2_0_program_enrollment
  process_3_0_session_attendance
  process_4_0_assessment_submission
  process_5_0_payment_financial
  process_6_0_communication_notification
  process_7_0_file_document
  process_8_0_reporting_analytics
}

TableGroup data_stores {
  datastore_d1_users
  datastore_d2_programs
  datastore_d3_enrollments
  datastore_d4_sessions
  datastore_d5_assessments
  datastore_d6_payments
  datastore_d7_communications
  datastore_d8_files
  datastore_d9_system_config
}